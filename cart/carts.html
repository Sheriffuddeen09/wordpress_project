<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart Page</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<style>

.head{
    background-color: #20bc7e;
  }

    @media (min-width: 310px) {
    .width-des{
      width: 260px;
      text-align: justify;
      font-size: 12px;
      padding: 2px;
    }
}
@media (min-width: 768px) {
    .width-des{
      width: 320px;
      font-size: 13px;
      text-align: justify;
    }
  }
  
</style>
<body class="bg-gray-100">
    <header>
        <div class="head font-roboto text-center text-sm sm:block hidden text-white p-1 -mb-2">
            Special Discount Alert: Flat 20% Off on Your Rental Needs!
        </div>
        <div class="head font-roboto text-center sm:hidden block text-white p-1 -mb-2" style="font-size: 8px;">
            Special Discount Alert: Flat 20% Off on Your Rental Needs!
        </div>
        <div class="flex flex-row justify-between items-center p-1 shadow-md">
            <div class="inline-flex sm:gap-6 items-center">
                <a href="index.html">
                    <img src="../layout/image/logo.png" alt="Logo" class="sm:w-20 w-32 sm:h-16  h-10 mt-2">

                </a>
                <div class="sm:block hidden">
                    <ul class="inline-flex gap-6 mt-4 items-center text-sm">
                        <li><a href="../index.html" class="hover:bg-gray-100 px-2 py-1 rounded">Home</a></li>
                        <li><a href="../shop.html" class="hover:bg-gray-100 px-2 py-1 rounded">Shop</a></li>
                        <li class="relative inline-flex items-center">
                            <!-- Category Button -->
                            <a href="../categorypage.html" class="hover:bg-gray-100 px-2 py-1 rounded">Category</a>
                        
                            <!-- Dropdown Toggle Button -->
                            <svg onclick="toggleDropdown()" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                                class="h-4 w-4 font-bold cursor-pointer">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path>
                            </svg>
                        
                            <!-- Dropdown List -->
                            <div id="categoryDropdown" class="hidden absolute top-9 left-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg p-2 z-50">
                                <p class="cursor-pointer hover:bg-gray-100 p-2 rounded" onclick="filterCategory('')">All</p>
                                <p class="cursor-pointer hover:bg-gray-100 p-2 rounded" onclick="filterCategory('Dogs')">Dogs</p>
                                <p class="cursor-pointer hover:bg-gray-100 p-2 rounded" onclick="filterCategory('Cats')">Cats</p>
                                <p class="cursor-pointer hover:bg-gray-100 p-2 rounded" onclick="filterCategory('Pet Carriers')">Pet Carriers</p>
                                <p class="cursor-pointer hover:bg-gray-100 p-2 rounded" onclick="filterCategory('Pet Clothing')">Pet Clothing</p>
                                <p class="cursor-pointer hover:bg-gray-100 p-2 rounded" onclick="filterCategory('Dog & Cat Beds')">Dog & Cat Beds</p>
                            </div>
                        </li>
                         
                          <li><a href="../aboutpage.html" class="hover:bg-gray-100 px-2 py-1 rounded">About</a></li>
                        <li><a href="../blogpage.html" class="hover:bg-gray-100 px-2 py-1 rounded">Blogs</a></li>
                    </ul>
                </div>
            </div>
            <div class="inline-flex sm:gap-6 mt-4 text-sm sm:mr-10 mr-10 items-center">
                <a href="../contactpage.html" class="hover:bg-gray-100 whitespace-nowrap px-2 py-1 rounded sm:block hidden">Help Center</a>
                <div class="flex flex-col w-full max-w-md mx-auto mt-2">
                    <div class="relative">
                        <!-- Search Button (Icon) -->
                        <button id="toggleSearch" class="px-1 pt-2 pb-1 rounded-full hover:bg-gray-200 transition">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 sm:-mt-2 -mt-3 text-black">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path>
                            </svg>
                        </button>
                
                        <!-- Transparent Background (Still Clickable) -->
                        <div id="searchContainer" class="fixed w-full z-10 inset-0 bg-black/40 hidden duration-300 flex justify-center trans">
                            <!-- Search Box (On Top of Transparency) -->
                            <div class="relative bg-white w-full p-4 rounded-lg shadow-lg z-50">
                                <div class="flex items-center border border-gray-300 rounded-lg bg-white">
                                    <input type="text" id="searchInput" placeholder="Search products..." class="w-full p-2 bg-white focus:outline-none rounded-lg">
                                    <button id="searchButton" class="bg-blue-500 text-white p-4 rounded-lg hover:bg-gray-200 transition">Search</button>
                                </div>
                                <!-- Search Results (On Top of Transparency) -->
                                <div id="searchResults" class="mt-3 w-full bg-white border border-gray-300 shadow-md rounded-lg hidden flex flex-col z-50"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="relative w-28 flex items-center">
                    <!-- Flag Image -->
                    <div class="absolute left-2 flex items-center">
                        <img id="flag" class="w-6 h-6 rounded-full border" alt="Flag">
                    </div>
                
                    <!-- Select Dropdown -->
                    <select id="countrySelect" class="w-full p-3 pl-10 border outline-pink-700 rounded-md appearance-none cursor-pointer">
                        <option value="+1" data-flag="https://flagcdn.com/w40/us.png">United States (+1)</option>
                        <option value="+44" data-flag="https://flagcdn.com/w40/gb.png">United Kingdom (+44)</option>
                        <option value="+1" data-flag="https://flagcdn.com/w40/ca.png">Canada (+1)</option>
                        <option value="+61" data-flag="https://flagcdn.com/w40/au.png">Australia (+61)</option>
                        <option value="+49" data-flag="https://flagcdn.com/w40/de.png">Germany (+49)</option>
                        <option value="+33" data-flag="https://flagcdn.com/w40/fr.png">France (+33)</option>
                        <option value="+91" data-flag="https://flagcdn.com/w40/in.png">India (+91)</option>
                        <option value="+234" data-flag="https://flagcdn.com/w40/ng.png">Nigeria (+234)</option>
                    </select>
                </div>
                                <a href="../dashboard/profile.html" class=" sm:block hidden hover:bg-gray-100 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5 text-black">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                  </svg>
                  </a>
                <a href="../cart/carts.html" class="inline-flex hover:bg-gray-100 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="text-black w-5 h-5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z" />
                  </svg>
                   <span id="cartCount hidden">0</span></a>
            </div>
            <div id="menuIcon" class="sm:hidden relative top-1 mt-1 right-0 bg-none z-50 p-2 rounded-full cursor-pointer">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                  </svg>
                  
            </div>
        </div>
     <!-- Mobile Menu -->
     <div id="menu" class="sm:hidden fixed top-0 right-0 w-52 h-full bg-white shadow-lg z-50 hidden">
        <div class="flex flex-col h-full">
            <!-- Menu Header -->
            <div class="flex justify-between items-center p-4">
                <img src="../layout/image/logo.png" alt="Logo" class="w-32 h-20">
                <svg id="closeMenu" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 cursor-pointer">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                </svg>
            </div>

            <!-- Navigation Links -->
            <nav class="flex flex-col gap-4 p-4">
                <a href="../index.html" class="text-black font-bold text-sm hover:bg-gray-100 px-5 py-1 rounded">Home</a>
                <div class="w-full bg-gray-200 h-0.5"></div>

                <a href="../shop.html" class="text-black font-bold text-sm hover:bg-gray-100 px-5 py-1 rounded">Shop</a>
                <div class="w-full bg-gray-200 h-0.5"></div>

                <!-- Category Dropdown -->
                <div id="dropMobileButton" class="flex items-center justify-between cursor-pointer hover:bg-gray-100 px-5 py-1 rounded">
                    <a href="../categorypage.html" class="text-black font-bold text-sm">Category</a>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                    </svg>
                </div>
                <div id="dropMobileMenu" class="hidden bg-white shadow-md rounded mt-2">
                    <a href="/category/all" class="block text-black font-bold text-sm py-1 px-4 hover:bg-gray-100">All</a>
                    <a href="/category/dogs" class="block text-black font-bold text-sm py-1 px-4 hover:bg-gray-100">Dogs</a>
                    <a href="/category/cats" class="block text-black font-bold text-sm py-1 px-4 hover:bg-gray-100">Cats</a>
                </div>

                <div class="w-full bg-gray-200 h-0.5"></div>
                <a href="../aboutpage.html" class="text-black font-bold text-sm hover:bg-gray-100 px-5 py-1 rounded">About</a>
                <div class="w-full bg-gray-200 h-0.5"></div>

                <a href="../blogpage.html" class="text-black font-bold text-sm hover:bg-gray-100 px-5 py-1 rounded">Blogs</a>
                <div class="w-full bg-gray-200 h-0.5"></div>

                <a href="../helppage.html" class="text-black font-bold text-sm hover:bg-gray-100 px-5 py-1 rounded">Help Center</a>
                <div class="w-full bg-gray-200 h-0.5"></div>

                <a href="../dashboard/profile.html" class="text-black font-bold text-sm hover:bg-gray-100 px-5 py-1 rounded">Dashboard</a>
            </nav>
        </div>
    </div>

    
</header>

    <div class="flex flex-col sm:flex-row gap-5 sm:mx-10">

        <div class="border border-pink-700 p-4 w-72 mx-auto mt-10 sm:w-96 mb-10 bg-white shadow-lg rounded-lg">
            <h2 class="text-pink-700 font-bold text-lg">Rental Duration</h2>
            <div id="rentalDuration"></div>
    
            <h2 class="text-pink-700 font-bold text-lg mt-4">Category</h2>
            <div id="categoryList"></div>
            <button id="toggleCategories" class="text-pink-700 mt-2">View All</button>
    
            <div class="w-full bg-pink-700 h-0.5 mt-1"></div>
    
            <h2 class="text-pink-700 font-bold text-lg mt-4">Location</h2>
            <input type="text" id="searchLocation" placeholder="Search location..." class="border p-2 w-full mb-2">
            <div id="locationList"></div>
            <button id="toggleLocations" class="text-pink-700 mt-2">View All</button>
    
            <div class="w-full bg-pink-700 h-0.5 mt-1"></div>
    
            <h2 class="text-pink-700 font-bold text-lg mt-4">Cart Totals</h2>
            <div class="flex justify-between">
                <span>Subtotal:</span>
                <span id="totalPrice">$0.00</span>
            </div>
            <div class="flex justify-between font-bold">
                <span>Total:</span>
                <span id="formattedTotalPrice">$0.00</span>
            </div>
    
            <div class="p-4 border border-gray-300 rounded mt-4">
                <h2 class="text-pink-700 font-bold text-lg">Payment Method</h2>
                <div class="flex justify-center gap-4 mt-2">
                    <img src="../cart/images/paypal.png" alt="PayPal" class="w-20 h-12 cursor-pointer">
                    <img src="../cart/images/googlepay.png" alt="Google Pay" class="w-16 h-12 cursor-pointer">
                    <img src="../cart/images/visa.png" alt="Visa" class="w-20 h-12 cursor-pointer">
                </div>
            </div>
    
            <button id="checkoutBtn" class="bg-pink-700 text-white w-full mt-4 p-2 rounded">
                Proceed to Checkout
            </button>
        </div>


        <div class="w-full sm:w-full mb-10 mx-auto p-5">
            <div id="loading" class="text-center hidden">Loading Cart...</div>
            <div id="cartContainer"></div>
            <p id="empty-cart" class="text-center font-bold text-xl my-32 flex justify-center gap-3 items-center hidden">
                No Cart to display
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z" />
                </svg>
            </p>
        </div>
        
    </div>
   
    <footer class="bg-cover bg-center bg-no-repeat py-8 px-6" style="background-image: url('../shop/image/background.png');">
        <div class="container mx-auto flex flex-wrap justify-around items-start gap-8">
            <!-- Left Section -->
            <div class="max-w-sm -mt-5">
                <div class="logo">
                    <a href="/">
                        <img src="../shop/image/logo.png" alt="Logo" class='w-28 h-16'>
                    </a>
                </div>
                
                <p class="mt-2 text-sm text-black font-bold">
                    Create heartwarming memories with this lovable Golden Retriever puppy – 
                    the perfect addition to your special moments! 🐾
                </p>
    
                <div class="mt-4">
                    <form action="/subscribe" method="POST">
                        <input type="email" name="email" placeholder="Email Address" class="p-2 w-full border border-pink-400 rounded-xl focus:outline-none text-sm" required />
                        <button type="submit" class="mt-2 w-full text-sm bg-pink-600 text-white py-2 rounded-xl hover:bg-black transition">
                            Sign Up
                        </button>
                    </form>
                </div>
    
                <!-- Social Icons -->
                <div class="flex space-x-4 mt-4">
                    <a href="#" class="text-black text-xl"><i class="fab fa-facebook"></i></a>
                    <a href="#" class="text-black text-xl"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="text-black text-xl"><i class="fab fa-google"></i></a>
                    <a href="#" class="text-black text-xl"><i class="fab fa-x-twitter"></i></a>
                    <a href="#" class="text-black text-xl"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>
    
            <!-- Middle Section -->
            <div class="grid grid-cols-2 gap-6 text-sm">
                <div>
                    <h3 class="font-bold text-black">Quick Links</h3>
                    <ul class="space-y-1 mt-2">
                        <li><a href="../aboutpage.html" class="hover:text-pink-700">About Us</a></li>
                        <li><a href="../contactpage.html" class="hover:text-pink-700">Contact Us</a></li>
                        <li><a href="../blogpage.html" class="hover:text-pink-700">Blog</a></li>
                        <li><a href="../inquirypage.html" class="hover:text-pink-700">FAQ</a></li>
                        <li><a href="../contactpage.html" class="hover:text-pink-700">Help</a></li>
                        <li><a href="../index.html" class="hover:text-pink-700">Returns</a></li>
                    </ul>
                </div>
    
                <div>
                    <h3 class="font-bold text-black">Product</h3>
                    <ul class="space-y-1 mt-2">
                        <li><a href="../categorypage.html" class="hover:text-pink-700">Pet Clothing</a></li>
                        <li><a href="#../categorypage.html" class="hover:text-pink-700">Pet Carriers</a></li>
                        <li><a href="../categorypage.html" class="hover:text-pink-700">Dog & Cat Beds</a></li>
                        <li><a href="../shop.html" class="hover:text-pink-700">Shop</a></li>
                        <li><a href="../shop/shipment.html" class="hover:text-pink-700">Shipping</a></li>
                        <li><a href="../order/orderhistory.html" class="hover:text-pink-700">Delivery</a></li>
                    </ul>
                </div>
            </div>
    
            <!-- Right Section -->
            <div class="text-sm">
                <h3 class="font-bold text-black">Our Locations</h3>
                <p class="mt-2 inline-flex gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z" />
                    </svg>
                    635 Rogers Street <br/> Downers Grove, IL 60515 USA
                </p>
                <p class="mt-1">
                    <a href="tel:+12345472344376" class="hover:text-pink-700">📞 +1 (234) 547 234 4376</a>
                </p>
                <div class="mt-4 flex sm:flex-col flex-row gap-2">
                    <img src="../layout/image/store.png" alt="Store" class='w-32 h-10'>
                    <img src="../layout/image/play.png" alt="Play Store" class='w-32 h-10'>
                </div>
            </div>
        </div>
    
        <hr class="my-6 border-pink-400"/>
        <p class="text-center text-sm font-bold">&copy; 2025 Shofx. All rights reserved.</p>
    </footer>
    
    <script>
       
        let globalCart = []; // Store fetched cart globally
        let selectedCategories = []; // Fix: Define this globally
        let selectedLocations = [];  // Fix: Define this globally
        let showAllCategories = false;
        let showAllLocations = false;


        async function fetchCart() {
    const userId = localStorage.getItem("user_id");

    if (!userId) {
        console.error("User ID is missing!");
        return;
    }

    try {
        document.getElementById("loading").style.display = "block";

        const response = await fetch(`http://localhost/mywebsite/function/cart.php?user_id=${userId}`);
        const data = await response.json();
        
        console.log("Cart API Response:", data); 

        document.getElementById("loading").style.display = "none";

        if (data.success && data.cart.length > 0) { 
            globalCart = data.cart;
            localStorage.setItem("cart", JSON.stringify(globalCart));
            displayCart(globalCart);
            updateTotalPrice();
        } else {
            console.warn("Cart is empty. Clearing localStorage.");
            document.getElementById("cartContainer").innerHTML = "<p class='text-center font-bold text-xl my-32'>No Cart to display</p>";
            localStorage.removeItem("cart");
        }
    } catch (error) {
        console.error("Error fetching cart:", error);
    }
}

function displayCart(cart) {
    const cartContainer = document.getElementById("cartContainer");
    cartContainer.innerHTML = "";

const cartImage = 'http://localhost/mywebsite/image/'
    
    cart.forEach(car => {
        const cartItem = document.createElement("div");
        cartItem.className = "flex gap-5 border border-pink-700 p-1 sm:p-5 flex-row flex-wrap";
        cartItem.innerHTML = `
            <div class="flex flex-col">
                <img src="${cartImage}${car.image}" alt="${car.title}" class="w-72 h-52" />
                <div class="inline-flex gap-6 flex-wrap hidden">
                    <div>
                        <p class="text-center font-bold">Pick up Date & Time</p>
                        <div class="border w-36 border-2 rounded-lg p-2 mx-auto border-pink-700 text-center">
                            <p>${car.pick_up_date}</p>
                            <p>${car.pick_up_time}</p>
                        </div>
                    </div>
                    <div>
                        <p class="text-center font-bold">Drop off Date & Time</p>
                        <div class="border w-36 border-2 rounded-lg p-2 mx-auto border-pink-700 text-center">
                            <p>${car.drop_off_date}</p>
                            <p>${car.drop_off_time}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex flex-col">
                <div class="flex flex-row justify-between items-center">
                    <p class="text-sm font-bold bg-[#7fffd4] sm:w-56 text-center p-1 rounded">${car.title}</p>
                    <button onclick="handleRemove(${car.cart_id})" class="size-10 cursor-pointer hover:bg-gray-200 px-2 py-1 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                        </svg>
                    </button>
                </div>
                <div class="inline-flex gap-3 items-center">
                    <p class='sm:w-52 w-48 my-2' style="font-size:13px">${car.location}</p>
                </div>
                <div class="inline-flex flex-wrap gap-5 sm:gap-0">
                    <p class="text-sm h-8 font-bold bg-[#7fffd4] text-center p-1 rounded w-20">$${car.price}</p>
                    <p class="width-des md:translate-x-0 lg:translate-x-10">${car.maintenance}</p>
                </div>
            </div>
        `;
        cartContainer.appendChild(cartItem);
    });
}

        const categories = ["Dogs", "Cats", "Pet Clothing", "Pet Carriers", "Dog & Cat Beds"];
        const locations = ["Houston", "San Francisco", "Seattle", "Florida", "Illinois", "New York", "Los Angeles", "Chicago", "Miami", "Dallas"];
        const rentalDurations = ["Per Hour", "Per Day"];


        const cart = [
            { category: "Dogs", location: "Houston", price: 20 },
            { category: "Cats", location: "New York", price: 15 },
            { category: "Pet Clothing", location: "Miami", price: 10 }
        ];

        
        function renderCategories() {
            const categoryList = document.getElementById("categoryList");
            categoryList.innerHTML = "";
            const visibleCategories = showAllCategories ? categories : categories.slice(0, 3);
            visibleCategories.forEach(category => {
                const label = document.createElement("label");
                label.className = "block flex items-center gap-2";
                label.innerHTML = `
                    <input type="checkbox" class="categoryCheckbox" value="${category}">
                    ${category}
                `;
                categoryList.appendChild(label);
            });
        }

        function renderLocations() {
            const locationList = document.getElementById("locationList");
            locationList.innerHTML = "";
            const visibleLocations = showAllLocations ? locations : locations.slice(0, 3);
            visibleLocations.forEach(location => {
                const label = document.createElement("label");
                label.className = "block";
                label.innerHTML = `
                    <input type="checkbox" class="locationCheckbox" value="${location}">
                    ${location}
                `;
                locationList.appendChild(label);
            });
        }

        function renderRentalDurations() {
            const rentalDurationDiv = document.getElementById("rentalDuration");
            rentalDurationDiv.innerHTML = "";
            rentalDurations.forEach(duration => {
                const label = document.createElement("label");
                label.className = "block";
                label.innerHTML = `
                    <input type="checkbox" class="rentalCheckbox" value="${duration}">
                    ${duration}
                `;
                rentalDurationDiv.appendChild(label);
            });
        }


function updateTotalPrice() {
    const filteredCart = globalCart.filter(item => 
        (selectedCategories.length === 0 || selectedCategories.includes(item.category)) &&
        (selectedLocations.length === 0 || selectedLocations.includes(item.location))
    );

    const totalPrice = filteredCart.reduce((acc, item) => acc + Number(item.price), 0);
    document.getElementById("totalPrice").textContent = `$${totalPrice.toFixed(2)}`;
    document.getElementById("formattedTotalPrice").textContent = `$${totalPrice.toFixed(2)}`;

    displayCart(filteredCart);
}

document.getElementById("toggleCategories").addEventListener("click", () => {
    showAllCategories = !showAllCategories;
    document.getElementById("toggleCategories").textContent = showAllCategories ? "View Less" : "View All";
    renderCategories();
});

document.getElementById("toggleLocations").addEventListener("click", () => {
    showAllLocations = !showAllLocations;
    document.getElementById("toggleLocations").textContent = showAllLocations ? "View Less" : "View All";
    renderLocations();
});

document.addEventListener("change", (event) => {
    if (event.target.classList.contains("categoryCheckbox")) {
        if (event.target.checked) {
            selectedCategories.push(event.target.value);
        } else {
            selectedCategories = selectedCategories.filter(c => c !== event.target.value);
        }
        updateTotalPrice();
    }

    if (event.target.classList.contains("locationCheckbox")) {
        if (event.target.checked) {
            selectedLocations.push(event.target.value);
        } else {
            selectedLocations = selectedLocations.filter(l => l !== event.target.value);
        }
        updateTotalPrice();
    }
});



        async function handleRemove(cartId) {
            const userId = localStorage.getItem("user_id");
            try {
                const response = await fetch(`http://localhost/mywebsite/function/removecart.php`, {
                    method: "DELETE",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ cart_id: cartId, user_id: userId })
                });
                const data = await response.json();
                if (data.success) {
                    fetchCart();
                } else {
                    console.error("Delete failed:", data.error);
                }
            } catch (error) {
                console.error("Error removing item:", error);
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
    if (typeof renderCategories === "function") renderCategories();
    if (typeof renderLocations === "function") renderLocations();
    if (typeof renderRentalDurations === "function") renderRentalDurations();
    fetchCart();
});



             
function searchMenu() {
    const toggleSearch = document.getElementById("toggleSearch");
    const searchContainer = document.getElementById("searchContainer");
    const searchInput = document.getElementById("searchInput");
    const searchButton = document.getElementById("searchButton");
    const resultsContainer = document.getElementById("searchResults");

    toggleSearch.addEventListener("click", () => {
        if (searchContainer.classList.contains("hidden")) {
            searchContainer.classList.remove("hidden");
            toggleSearch.classList.add("hidden"); // Hide search icon
            setTimeout(() => searchContainer.classList.remove("opacity-0"), 10);
            searchInput.focus();
        } else {
            searchContainer.classList.add("opacity-0");
            toggleSearch.classList.remove("hidden"); // Show search icon
            setTimeout(() => searchContainer.classList.add("hidden"), 300);
        }
    });

    // Close search box when clicking outside
    document.addEventListener("click", (event) => {
        if (!searchContainer.contains(event.target) && !toggleSearch.contains(event.target)) {
            searchContainer.classList.add("opacity-0");
            setTimeout(() => {
                searchContainer.classList.add("hidden");
                toggleSearch.classList.remove("hidden"); // Show search icon again
            }, 300);
        }
    });

    const handleSearch = async () => {
        const query = searchInput.value.trim();

        if (query === "") {
            resultsContainer.innerHTML = "";
            return;
        }

        try {
            const response = await fetch(`http://localhost/mywebsite/function/product.php?search=${encodeURIComponent(query)}`);
            if (!response.ok) throw new Error("Network response was not ok");

            const data = await response.json();
            console.log("Fetched Data:", data); // Debugging log

            const products = data.message || [];
            displayResults(products);
        } catch (error) {
            console.error("Search error:", error);
            resultsContainer.innerHTML = `<p class="text-red-500 text-sm">Error fetching results. Check console.</p>`;
        }
    };

    const productUrl = 'http://localhost/mywebsite/image/';

    const searchResults = document.getElementById("searchResults");

    const displayResults = (products) => {
    if (!Array.isArray(products) || products.length === 0) {
        searchResults.innerHTML = `<p class="text-gray-500 text-sm p-2">No products found.</p>`;
        searchResults.classList.remove("hidden");
        return;
    }

    searchResults.innerHTML = products.map(product => `
        <div class="w-full p-4 flex items-center gap-4 border-b last:border-none hover:bg-gray-100 transition duration-200 cursor-pointer"
            onclick="window.location.href='shop/product.html?id=${product.id}'">
            <img src="http://localhost/mywebsite/image/${product.image}" alt="${product.title}" class="w-16 h-16 object-cover rounded-md"/>
            <div class="flex-1">
                <p class="text-gray-800 font-semibold">${product.title}</p>
            </div>
        </div>
    `).join("");

    searchResults.classList.remove("hidden");
};

    searchInput.addEventListener("input", handleSearch);
    searchButton.addEventListener("click", handleSearch);
}

function initializeMenu() {
    const menu = document.getElementById("menu");
    const menuIcon = document.getElementById("menuIcon");
    const closeMenu = document.getElementById("closeMenu");

    if (menu && menuIcon && closeMenu) {
        // Open menu
        menuIcon.addEventListener("click", function () {
            menu.classList.remove("hidden"); // Show menu
            menuIcon.classList.add("hidden"); // Hide menu icon
        });

        // Close menu
        closeMenu.addEventListener("click", function () {
            menu.classList.add("hidden"); // Hide menu
            menuIcon.classList.remove("hidden"); // Show menu icon
        });
    }
}

function initializeCountrySelect() {
    const countrySelect = document.getElementById("countrySelect");
    const flagImg = document.getElementById("flag");

    countrySelect.addEventListener("change", function () {
        const selectedOption = this.options[this.selectedIndex];
        flagImg.src = selectedOption.getAttribute("data-flag");
        flagImg.alt = selectedOption.textContent;
    });

    // Initialize with the first selected country's flag All
    const initialOption = countrySelect.options[countrySelect.selectedIndex];
    flagImg.src = initialOption.getAttribute("data-flag");
    flagImg.alt = initialOption.textContent;
}

        // Call the function after the page loads

        document.addEventListener("DOMContentLoaded", function () {
    // Apply category filtering when the page loads
    applyCategoryFilter();
});

// Toggle dropdown visibility
function toggleDropdown() {
    const dropdown = document.getElementById("categoryDropdown");
    dropdown.classList.toggle("hidden");
}

// Function to redirect to categorypage.html with selected category
function filterCategory(category) {
    toggleDropdown(); // Close the dropdown
    window.location.href = `categorypage.html?category=${encodeURIComponent(category)}`;
}

    
searchMenu()
initializeCountrySelect() 
initializeMenu()

    </script>
</body>
</html>
